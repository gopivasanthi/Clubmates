@model IEnumerable<Clubmates.Web.Areas.Club.Models.>

@{
    ViewData["Title"] = "Manage Members";
}

<div class="container mt-4">
    <h2 class="mb-4">List of existing Members</h2>
    @if (Model is not null)
    {
        <table class="table table-striped table-bordered">
            <thead class="thead-dark">
                <tr>
                    <th><span>Name<span class="arrow-down" onclick="sortTable('FirstName', this)"></span><span class="arrow-up" onclick="descendSortTable('FirstName', this)"></span></span></th>
                    <th><span>User Name<span class="arrow-down" onclick="sortTable('UserName', this)"></span><span class="arrow-up" onclick="descendSortTable('UserName', this)"></span></span></th>
                    <th><span>Role<span class="arrow-down" onclick="sortTable('Role', this)"></span><span class="arrow-up" onclick="descendSortTable('Role', this)"></span></span></th>
                    <th><span>Actions<span class="arrow-down" onclick="sortTable('IsApproved', this)"></span><span class="arrow-up" onclick="descendSortTable('IsApproved', this)"></span></span></th>
                </tr>
            </thead>
            <tbody>
                @foreach (var account in Model)
                {
                    <tr>
                        <td>@account.FirstName</td>
                        <td>@account.UserName</td>
                        <td>@account.SelectedRole</td>
                        @if (account.IsAccountApproved)
                        {
                            <td>
                                <a href="/" class="btn btn-success-approved btn-sm">Approved</a>
                            </td>
                        }
                        else
                        {
                            <td>
                                <a href="@Url.Action("ApproveMember", "Admin", new { emailId = account.EmailId })" class="btn btn-primary btn-sm">Approve</a>
                            </td>
                        }
                    </tr>
                }
            </tbody>

        </table>
    }
    else
    {
        <div>No members available!</div>
    }
</div>


@section Scripts {
    <script type="text/javascript">
        function sortTable(column, element) {
            debugger;
            // Remove active class from all arrows
            document.querySelectorAll('.arrow-down, .arrow-up').forEach(function(arrow) {
                arrow.classList.remove('active');
            });

            // Add active class to the clicked arrow
            element.classList.add('active');

            $.ajax({
                url: '@Url.Action("SortTable", "Admin")',
                type: 'GET',
                data: { sortColumn: column },
                success: function (result) {
                    $('.container').html(result);
                }
            });
        }
        function descendSortTable(column, element) {
            // Remove active class from all arrows
            document.querySelectorAll('.arrow-down, .arrow-up').forEach(function(arrow) {
                arrow.classList.remove('active');
            });

            // Add active class to the clicked arrow
            element.classList.add('active');

            $.ajax({
                url: '@Url.Action("DescendSortTable", "Admin")',
                type: 'GET',
                data: { sortColumn: column },
                success: function (result) {
                    $('.container').html(result);
                }
            });
        }
    </script>
}